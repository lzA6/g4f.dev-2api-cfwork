# ğŸš€ AI Gateway Cloudflare Worker v3.0 - æ™ºèƒ½APIç½‘å…³

<div align="center">

![AI Gateway](https://img.shields.io/badge/AI-Gateway-00aaff?style=for-the-badge&logo=ai&logoColor=white)
![Cloudflare Workers](https://img.shields.io/badge/Cloudflare-Workers-F38020?style=for-the-badge&logo=cloudflare&logoColor=white)
![OpenAI Compatible](https://img.shields.io/badge/OpenAI-Compatible-00a67d?style=for-the-badge)
![Apache 2.0](https://img.shields.io/badge/License-Apache%202.0-blue?style=for-the-badge)

**âœ¨ ä¸€ä¸ªèƒ½è‡ªæˆ‘é…ç½®çš„æ™ºèƒ½APIç½‘å…³ - è®©AIè°ƒç”¨å˜å¾—ç®€å•å¦‚å‘¼å¸ âœ¨**

*"ä¸å†éœ€è¦å…³å¿ƒæ¨¡å‹æ¥è‡ªå“ªé‡Œï¼Œåªéœ€å‘Šè¯‰å®ƒä½ æƒ³è¦ä»€ä¹ˆ"*

[å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹-æ‡’äººä¸“å±) | [æŠ€æœ¯åŸç†](#-æŠ€æœ¯åŸç†è¯¦è§£) | [ä½¿ç”¨æ•™ç¨‹](#-è¯¦ç»†ä½¿ç”¨æ•™ç¨‹) | [å¼€å‘æŒ‡å—](#-å¼€å‘è€…æ‰©å±•æŒ‡å—)

</div>

## ğŸ“‹ ç›®å½•
- [ğŸ¯ é¡¹ç›®ç®€ä»‹](#-é¡¹ç›®ç®€ä»‹)
- [ğŸŒŸ æ ¸å¿ƒç‰¹æ€§](#-æ ¸å¿ƒç‰¹æ€§)
- [ğŸš€ å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹-æ‡’äººä¸“å±)
- [ğŸ› ï¸ è¯¦ç»†ä½¿ç”¨æ•™ç¨‹](#-è¯¦ç»†ä½¿ç”¨æ•™ç¨‹)
- [ğŸ§  æŠ€æœ¯åŸç†è¯¦è§£](#-æŠ€æœ¯åŸç†è¯¦è§£)
- [ğŸ—ï¸ æ¶æ„è®¾è®¡](#-æ¶æ„è®¾è®¡)
- [ğŸ”§ å¼€å‘è€…æ‰©å±•æŒ‡å—](#-å¼€å‘è€…æ‰©å±•æŒ‡å—)
- [ğŸ“Š é¡¹ç›®ç°çŠ¶](#-é¡¹ç›®ç°çŠ¶)
- [ğŸ¯ é€‚ç”¨åœºæ™¯](#-é€‚ç”¨åœºæ™¯)
- [ğŸ”® æœªæ¥è§„åˆ’](#-æœªæ¥è§„åˆ’)
- [ğŸ“ é¡¹ç›®ç»“æ„](#-é¡¹ç›®ç»“æ„)
- [ğŸ¤ è´¡çŒ®æŒ‡å—](#-è´¡çŒ®æŒ‡å—)
- [ğŸ“„ å¼€æºåè®®](#-å¼€æºåè®®)

## ğŸ¯ é¡¹ç›®ç®€ä»‹

> ğŸ’¡ **å“²å­¦æ€è€ƒ**ï¼šåœ¨AIçˆ†ç‚¸çš„æ—¶ä»£ï¼Œæˆ‘ä»¬æ˜¯å¦åº”è¯¥è®©æŠ€æœ¯é€‚åº”äººç±»ï¼Œè€Œä¸æ˜¯äººç±»é€‚åº”æŠ€æœ¯ï¼Ÿ

è¿™æ˜¯ä¸€ä¸ªé©å‘½æ€§çš„**å•æ–‡ä»¶Cloudflare Workeræ™ºèƒ½ç½‘å…³**ï¼Œå®ƒä¸å†ä»…ä»…æ˜¯ä¸€ä¸ªç®€å•çš„ä»£ç†ï¼Œè€Œæ˜¯ä¸€ä¸ªå…·å¤‡è‡ªæˆ‘æ„è¯†çš„APIè·¯ç”±å¤§è„‘ï¼æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æœ‰ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå®ƒçŸ¥é“æ‰€æœ‰AIæœåŠ¡çš„"ç”µè¯å·ç "ï¼Œä½ åªéœ€è¦è¯´å‡ºæƒ³æ‰¾çš„äººï¼ˆæ¨¡å‹ï¼‰ï¼Œå®ƒè‡ªåŠ¨å¸®ä½ è½¬æ¥åˆ°æ­£ç¡®çš„åœ°æ–¹ã€‚

### ğŸª ç”ŸåŠ¨æ¯”å–»
- **ä¼ ç»Ÿæ–¹å¼**ï¼šåƒåœ¨é™Œç”ŸåŸå¸‚æ‰¾é¤å…ï¼Œéœ€è¦çŸ¥é“æ¯ä¸ªé¤å…çš„å…·ä½“åœ°å€
- **æˆ‘ä»¬çš„æ–¹æ¡ˆ**ï¼šåƒä½¿ç”¨ç¾é£ŸAPPï¼Œåªéœ€è¦è¾“å…¥æƒ³åƒçš„èœåï¼ŒAPPè‡ªåŠ¨æ¨èå¹¶å¯¼èˆªåˆ°æœ€ä½³é¤å…

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

| ç‰¹æ€§ | æè¿° | ä¼˜åŠ¿ |
|------|------|------|
| ğŸ§  **æ™ºèƒ½è·¯ç”±** | è‡ªåŠ¨æ ¹æ®æ¨¡å‹åç§°è·¯ç”±åˆ°æ­£ç¡®ä¸Šæ¸¸ | æ— éœ€è®°å¿†å¤æ‚APIç«¯ç‚¹ |
| ğŸ“š **ç»Ÿä¸€ç›®å½•** | èšåˆæ‰€æœ‰æä¾›å•†çš„æ¨¡å‹åˆ—è¡¨ | ä¸€ç«™å¼æ¨¡å‹å‘ç° |
| ğŸ¯ **OpenAIå…¼å®¹** | å®Œå…¨å…¼å®¹OpenAI APIæ ¼å¼ | æ— ç¼æ¥å…¥ç°æœ‰å·¥å…· |
| âš¡ **æ— æœåŠ¡å™¨** | åŸºäºCloudflare Workers | å…¨çƒåŠ é€Ÿï¼ŒæŒ‰é‡ä»˜è´¹ |
| ğŸ”§ **è‡ªé…ç½®** | å¯åŠ¨æ—¶è‡ªåŠ¨æ„å»ºæ¨¡å‹æ˜ å°„ | å…æ‰‹åŠ¨é…ç½® |
| ğŸ¨ **å‹å¥½UI** | å†…ç½®äº¤äº’å¼æµ‹è¯•ç•Œé¢ | å¼€ç®±å³ç”¨ |

## ğŸš€ å¿«é€Ÿå¼€å§‹ (æ‡’äººä¸“å±)

### âš¡ ä¸€é”®éƒ¨ç½²

[![Deploy to Cloudflare](https://deploy.workers.cloudflare.com/button)](https://deploy.workers.cloudflare.com/?url=https://github.com/lzA6/g4f.dev-2api-cfwork)

**æˆ–è€…æ‰‹åŠ¨éƒ¨ç½²ï¼š**

1. **å…‹éš†ä»“åº“**
   ```bash
   git clone https://github.com/lzA6/g4f.dev-2api-cfwork.git
   cd g4f.dev-2api-cfwork
   ```

2. **å®‰è£…Wrangler CLI**
   ```bash
   npm install -g wrangler
   ```

3. **ç™»å½•Cloudflare**
   ```bash
   wrangler login
   ```

4. **éƒ¨ç½²ï¼**
   ```bash
   wrangler deploy
   ```

ğŸ‰ **æ­å–œï¼ä½ çš„æ™ºèƒ½AIç½‘å…³å·²ç»ä¸Šçº¿ï¼**

### ğŸ”‘ è·å–è¿æ¥ä¿¡æ¯
éƒ¨ç½²å®Œæˆåï¼Œä½ ä¼šè·å¾—ä¸€ä¸ªç±»ä¼¼è¿™æ ·çš„URLï¼š
```
https://your-worker.your-account.workers.dev
```

**é‡è¦é…ç½®ä¿¡æ¯ï¼š**
- **API Base URL**: `https://your-worker.your-account.workers.dev/v1`
- **API Key**: `1` (æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ï¼)
- **æ¨¡å‹åç§°**: è®¿é—®ä½ çš„workeræ ¹è·¯å¾„æŸ¥çœ‹å¯ç”¨æ¨¡å‹

## ğŸ› ï¸ è¯¦ç»†ä½¿ç”¨æ•™ç¨‹

### ğŸ“± æ–¹æ³•ä¸€ï¼šé€šè¿‡Webç•Œé¢ï¼ˆå°ç™½å‹å¥½ï¼‰

1. è®¿é—®ä½ çš„Worker URLï¼ˆå¦‚ï¼š`https://your-worker.your-account.workers.dev`ï¼‰
2. ä½ ä¼šçœ‹åˆ°ä¸€ä¸ªæ¼‚äº®çš„æ§åˆ¶é¢æ¿
3. ä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©ä¸€ä¸ªæ¨¡å‹
4. è¾“å…¥ä½ çš„é—®é¢˜
5. ç‚¹å‡»"å‘é€"æŒ‰é’®
6. ğŸŠ è§è¯å¥‡è¿¹çš„æ—¶åˆ»ï¼

### ğŸ”Œ æ–¹æ³•äºŒï¼šé€šè¿‡APIï¼ˆå¼€å‘è€…é¦–é€‰ï¼‰

#### è·å–æ¨¡å‹åˆ—è¡¨
```bash
curl "https://your-worker.your-account.workers.dev/v1/models" \
  -H "Authorization: Bearer 1"
```

#### å‘é€èŠå¤©è¯·æ±‚
```bash
curl "https://your-worker.your-account.workers.dev/v1/chat/completions" \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer 1" \
  -d '{
    "model": "gpt-4o-mini",
    "messages": [
      {
        "role": "user",
        "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹è‡ªå·±"
      }
    ],
    "stream": true
  }'
```

### ğŸ› ï¸ æ–¹æ³•ä¸‰ï¼šé›†æˆåˆ°ç¬¬ä¸‰æ–¹åº”ç”¨

#### é…ç½®OpenAIå®¢æˆ·ç«¯
```python
# Pythonç¤ºä¾‹
from openai import OpenAI

client = OpenAI(
    base_url="https://your-worker.your-account.workers.dev/v1",
    api_key="1"
)

response = client.chat.completions.create(
    model="gpt-4o-mini",
    messages=[{"role": "user", "content": "Hello!"}]
)
```

## ğŸ§  æŠ€æœ¯åŸç†è¯¦è§£

### ğŸ—ï¸ æ ¸å¿ƒæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯è¯·æ±‚     â”‚    â”‚  æ™ºèƒ½ç½‘å…³Worker   â”‚    â”‚  ä¸Šæ¸¸AIæä¾›å•†    â”‚
â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚
â”‚ OpenAIæ ¼å¼è¯·æ±‚  â”‚â”€â”€â”€â–¶â”‚ 1. éªŒè¯APIå¯†é’¥    â”‚â”€â”€â”€â–¶â”‚ å®é™…AIæœåŠ¡      â”‚
â”‚ model: "xxx"    â”‚    â”‚ 2. æŸ¥æ‰¾æ¨¡å‹è·¯ç”±   â”‚    â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ 3. è½¬å‘è¯·æ±‚       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚ 4. è¿”å›å“åº”       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                  â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ç•Œé¢       â”‚    â”‚ ğŸ§  æ¨¡å‹æ˜ å°„è¡¨     â”‚    â”‚ å¦ä¸€ä¸ªAIæä¾›å•†   â”‚
â”‚ äº¤äº’å¼æµ‹è¯•é¢æ¿   â”‚â—€â”€â”€â–¶â”‚ gpt-4o-mini â†’ A  â”‚â”€â”€â”€â–¶â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ llama3     â†’ B    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”§ å…³é”®æŠ€æœ¯è§£æ

#### 1. ğŸ—ºï¸ æ¨¡å‹-æä¾›å•†æ˜ å°„ç³»ç»Ÿ (`MODEL_PROVIDER_MAP`)

```javascript
// è¿™æ˜¯ä¸€ä¸ªå…¨å±€Mapå¯¹è±¡ï¼Œå­˜å‚¨æ¨¡å‹åˆ°æä¾›å•†çš„æ˜ å°„å…³ç³»
// ç»“æ„: Map<modelId, {providerId, upstreamHost, chatPath}>
MODEL_PROVIDER_MAP = new Map([
  ['gpt-4o-mini', {
    providerId: 'api.airforce',
    upstreamHost: 'api.airforce',
    chatPath: '/v1/chat/completions'
  }],
  // ... æ›´å¤šæ¨¡å‹æ˜ å°„
]);
```

**æŠ€æœ¯è¦ç‚¹**ï¼š
- **æ•°æ®ç»“æ„**: ä½¿ç”¨ES6 Mapï¼ŒæŸ¥æ‰¾æ—¶é—´å¤æ‚åº¦O(1)
- **ç¼“å­˜ç­–ç•¥**: Workerå¯åŠ¨æ—¶æ„å»ºï¼Œé¿å…é‡å¤è¯·æ±‚
- **å®¹é”™å¤„ç†**: ä½¿ç”¨Promise.allSettledï¼Œå•ä¸ªæä¾›å•†å¤±è´¥ä¸å½±å“æ•´ä½“

#### 2. ğŸš¦ æ™ºèƒ½è·¯ç”±ç®—æ³•

```javascript
async function handleChatCompletionRequest(request) {
  // 1. è§£æè¯·æ±‚ä½“ï¼Œæå–modelå­—æ®µ
  const requestBody = await request.json();
  const modelId = requestBody.model;
  
  // 2. åœ¨æ˜ å°„è¡¨ä¸­æŸ¥æ‰¾å¯¹åº”çš„æä¾›å•†ä¿¡æ¯
  const providerInfo = MODEL_PROVIDER_MAP.get(modelId);
  
  // 3. æ„å»ºä¸Šæ¸¸è¯·æ±‚URLå’Œheaders
  const upstreamUrl = `https://${providerInfo.upstreamHost}${providerInfo.chatPath}`;
  
  // 4. è½¬å‘è¯·æ±‚å¹¶è¿”å›å“åº”
  return await fetch(upstreamRequest);
}
```

#### 3. ğŸ¨ å“åº”å¼UIç»„ä»¶

å‰ç«¯ç•Œé¢ä½¿ç”¨çº¯HTML/CSS/JSå®ç°ï¼ŒåŒ…å«ï¼š
- **æ¨¡å‹é€‰æ‹©å™¨**: åŠ¨æ€åŠ è½½çš„`<select>`å…ƒç´ 
- **å®æ—¶èŠå¤©**: ä½¿ç”¨Server-Sent Events (SSE) å®ç°æµå¼å“åº”
- **å¤åˆ¶åŠŸèƒ½**: åŸºäºClipboard APIçš„ä¸€é”®å¤åˆ¶

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ğŸ“Š ç³»ç»Ÿç»„ä»¶å›¾

```mermaid
graph TB
    A[å®¢æˆ·ç«¯è¯·æ±‚] --> B{è·¯ç”±åˆ†å‘}
    B --> C[æ¨¡å‹åˆ—è¡¨ç«¯ç‚¹]
    B --> D[èŠå¤©å®Œæˆç«¯ç‚¹]
    B --> E[Webç•Œé¢]
    
    C --> F[æ¨¡å‹æ˜ å°„ç³»ç»Ÿ]
    D --> G[è®¤è¯ä¸­é—´ä»¶]
    G --> H[æ¨¡å‹è·¯ç”±æŸ¥æ‰¾]
    H --> I[ä¸Šæ¸¸è¯·æ±‚ä»£ç†]
    
    F --> J[æä¾›å•†é…ç½®]
    I --> K[å¤šä¸ªä¸Šæ¸¸API]
    
    E --> L[å‰ç«¯JSé€»è¾‘]
    L --> M[å®æ—¶SSEæµ]
    
    subgraph "æ•°æ®æµ"
        N[è¯·æ±‚æµ] --> O[å“åº”æµ]
        P[æ¨¡å‹æ•°æ®] --> Q[UIæ¸²æŸ“]
    end
```

### ğŸ”„ è¯·æ±‚å¤„ç†æµç¨‹

1. **æ¥æ”¶è¯·æ±‚** â†’ 2. **è·¯å¾„è·¯ç”±** â†’ 3. **è®¤è¯éªŒè¯** â†’ 4. **æ¨¡å‹è§£æ** â†’ 5. **ä¸Šæ¸¸è½¬å‘** â†’ 6. **å“åº”è¿”å›**

## ğŸ”§ å¼€å‘è€…æ‰©å±•æŒ‡å—

### ğŸ¯ æ·»åŠ æ–°çš„AIæä¾›å•†

æƒ³è¦æ·»åŠ æ–°çš„AIæœåŠ¡ï¼Ÿè¶…çº§ç®€å•ï¼

```javascript
// åœ¨ PROVIDER_CONFIG ä¸­æ·»åŠ æ–°æ¡ç›®
const PROVIDER_CONFIG = {
  // ... ç°æœ‰é…ç½®
  
  'my-new-provider': {  // ğŸ”‘ æä¾›å•†IDï¼ˆå”¯ä¸€æ ‡è¯†ç¬¦ï¼‰
    name: 'æˆ‘çš„æ–°AIæœåŠ¡', // ğŸ“ æ˜¾ç¤ºåç§°
    upstreamHost: 'api.my-new-ai.com', // ğŸŒ ä¸Šæ¸¸ä¸»æœºåœ°å€
    modelsPath: '/v1/models', // ğŸ“‹ æ¨¡å‹åˆ—è¡¨ç«¯ç‚¹ï¼ˆå¯é€‰ï¼‰
    chatPath: '/v1/chat/completions' // ğŸ’¬ èŠå¤©ç«¯ç‚¹
  }
  
  // æˆ–è€…å¯¹äºç¡¬ç¼–ç æ¨¡å‹çš„æä¾›å•†ï¼š
  'simple-provider': {
    name: 'ç®€å•AIæœåŠ¡',
    upstreamHost: 'simple.ai',
    models: ['model-a', 'model-b'], // ğŸ¯ ç›´æ¥æŒ‡å®šæ¨¡å‹
    chatPath: '/api/chat'
  }
};
```

### ğŸ”„ æ‰©å±•æ¨¡å‹è§£æé€»è¾‘

å¦‚æœéœ€è¦å¤„ç†ç‰¹æ®Šæ ¼å¼çš„æ¨¡å‹åˆ—è¡¨å“åº”ï¼š

```javascript
// åœ¨ buildModelProviderMap å‡½æ•°ä¸­æ·»åŠ æ–°çš„è§£æé€»è¾‘
if (providerId === 'special-provider') {
  // è‡ªå®šä¹‰è§£æé€»è¾‘
  models = data.specialFormat.models.map(m => m.modelId);
}
```

### ğŸ¨ è‡ªå®šä¹‰UIä¸»é¢˜

ä¿®æ”¹CSSå˜é‡å³å¯æ”¹å˜æ•´ä½“ä¸»é¢˜ï¼š

```css
:root {
  --bg-color: #ä½ çš„èƒŒæ™¯è‰²;
  --primary-color: #ä½ çš„ä¸»è‰²è°ƒ;
  --text-color: #ä½ çš„æ–‡å­—é¢œè‰²;
}
```

## ğŸ“Š é¡¹ç›®ç°çŠ¶

### âœ… å·²å®ŒæˆåŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | çŠ¶æ€ | å®Œæˆåº¦ |
|----------|------|--------|
| æ ¸å¿ƒè·¯ç”±ç³»ç»Ÿ | âœ… å®Œæˆ | 100% |
| æ¨¡å‹è‡ªåŠ¨å‘ç° | âœ… å®Œæˆ | 100% |
| å¤šæä¾›å•†æ”¯æŒ | âœ… å®Œæˆ | 100% |
| Webäº¤äº’ç•Œé¢ | âœ… å®Œæˆ | 100% |
| OpenAIå…¼å®¹ | âœ… å®Œæˆ | 100% |
| æµå¼å“åº” | âœ… å®Œæˆ | 100% |

### ğŸš§ å¾…å®Œå–„åŠŸèƒ½

| åŠŸèƒ½ | ä¼˜å…ˆçº§ | é¢„è®¡éš¾åº¦ | æè¿° |
|------|--------|----------|------|
| è¯·æ±‚é‡è¯•æœºåˆ¶ | ğŸ”´ é«˜ | â­â­ | ä¸Šæ¸¸å¤±è´¥æ—¶è‡ªåŠ¨é‡è¯•å…¶ä»–æä¾›å•† |
| è´Ÿè½½å‡è¡¡ | ğŸ”´ é«˜ | â­â­â­ | åŒæ¨¡å‹å¤šæä¾›å•†æ—¶çš„æ™ºèƒ½åˆ†é… |
| ä½¿ç”¨é‡ç»Ÿè®¡ | ğŸŸ¡ ä¸­ | â­â­ | APIè°ƒç”¨æ¬¡æ•°å’ŒæˆåŠŸç‡ç»Ÿè®¡ |
| ç¼“å­˜ä¼˜åŒ– | ğŸŸ¡ ä¸­ | â­â­ | å“åº”ç¼“å­˜æå‡æ€§èƒ½ |
| é€Ÿç‡é™åˆ¶ | ğŸŸ¢ ä½ | â­ | é˜²æ­¢APIæ»¥ç”¨ |

## ğŸ¯ é€‚ç”¨åœºæ™¯

### ğŸŒŸ å®Œç¾åŒ¹é…çš„ä½¿ç”¨æ¡ˆä¾‹

1. **ğŸš€ ä¸ªäººå¼€å‘è€…**
   - å¿«é€Ÿæ­å»ºAIæµ‹è¯•ç¯å¢ƒ
   - å¤šæ¨¡å‹å¯¹æ¯”æµ‹è¯•
   - å­¦ä¹ å’Œå®éªŒAIåº”ç”¨

2. **ğŸ¢ ä¸­å°ä¼ä¸š**
   - æˆæœ¬å¯æ§çš„AIæœåŠ¡æ¥å…¥
   - é¿å…ä¾›åº”å•†é”å®š
   - å¿«é€ŸåŸå‹å¼€å‘

3. **ğŸ“ æ•™è‚²ç ”ç©¶**
   - å­¦ç”ŸAIå­¦ä¹ å¹³å°
   - å¤šæ¨¡å‹æ€§èƒ½å¯¹æ¯”
   - ç®—æ³•ç ”ç©¶æµ‹è¯•

### âš ï¸ ä½¿ç”¨é™åˆ¶

1. **æ€§èƒ½ä¾èµ–**: ä¾èµ–ä¸Šæ¸¸APIçš„å“åº”é€Ÿåº¦
2. **åŠŸèƒ½é™åˆ¶**: ä»…æ”¯æŒèŠå¤©å®Œæˆæ¥å£
3. **ç¨³å®šæ€§**: å—ä¸Šæ¸¸æœåŠ¡å¯ç”¨æ€§å½±å“

## ğŸ”® æœªæ¥è§„åˆ’

### ğŸ¯ æŠ€æœ¯æ¼”è¿›è·¯çº¿

**é˜¶æ®µä¸€ï¼šåŸºç¡€ç¨³å›º** (å½“å‰)
- âœ… æ ¸å¿ƒè·¯ç”±åŠŸèƒ½
- âœ… åŸºç¡€UIç•Œé¢
- âœ… å¤šæä¾›å•†æ”¯æŒ

**é˜¶æ®µäºŒï¼šåŠŸèƒ½å¢å¼º** (çŸ­æœŸç›®æ ‡)
- ğŸ”„ è¯·æ±‚é‡è¯•å’Œé™çº§
- ğŸ”„ åŸºç¡€ç›‘æ§ç»Ÿè®¡
- ğŸ”„ æ–‡æ¡£å®Œå–„

**é˜¶æ®µä¸‰ï¼šæ™ºèƒ½ä¼˜åŒ–** (ä¸­æœŸç›®æ ‡)
- ğŸ• æ™ºèƒ½è´Ÿè½½å‡è¡¡
- ğŸ• é¢„æµ‹æ€§ç¼“å­˜
- ğŸ• è‡ªé€‚åº”è·¯ç”±

**é˜¶æ®µå››ï¼šç”Ÿæ€å»ºè®¾** (é•¿æœŸç›®æ ‡)
- ğŸŒŸ æ’ä»¶ç³»ç»Ÿ
- ğŸŒŸ å¸‚åœºç”Ÿæ€
- ğŸŒŸ ä¼ä¸šç‰¹æ€§

## ğŸ“ é¡¹ç›®ç»“æ„

```
g4f.dev-2api-cfwork/
â”œâ”€â”€ ğŸ“„ README.md                    # é¡¹ç›®è¯´æ˜æ–‡æ¡£ (å°±æ˜¯è¿™ä¸ªæ–‡ä»¶!)
â”œâ”€â”€ ğŸ”§ wrangler.toml                # Cloudflare Workersé…ç½®
â”œâ”€â”€ ğŸ“¦ package.json                 # é¡¹ç›®ä¾èµ–é…ç½®
â””â”€â”€ ğŸš€ src/
    â””â”€â”€ ğŸ“„ worker.js                # ğŸ¯ æ ¸å¿ƒWorkerä»£ç  (å•æ–‡ä»¶æ¶æ„!)

# ğŸ—‚ï¸ è™šæ‹Ÿæ–‡ä»¶ç»“æ„ (ä»£ç å†…ç»„ç»‡)
worker.js å†…éƒ¨ç»“æ„:
â”œâ”€â”€ âš™ï¸ ç¡¬ç¼–ç é…ç½®åŒºåŸŸ
â”‚   â”œâ”€â”€ WORKER_API_KEY
â”‚   â””â”€â”€ PROVIDER_CONFIG
â”œâ”€â”€ ğŸ§  æ™ºèƒ½æ ¸å¿ƒç³»ç»Ÿ
â”‚   â”œâ”€â”€ MODEL_PROVIDER_MAP
â”‚   â””â”€â”€ buildModelProviderMap()
â”œâ”€â”€ ğŸš€ Workerä¸»å…¥å£
â”‚   â””â”€â”€ fetch() äº‹ä»¶å¤„ç†å™¨
â”œâ”€â”€ ğŸ”Œ APIè¯·æ±‚å¤„ç†å™¨
â”‚   â”œâ”€â”€ handleChatCompletionRequest()
â”‚   â””â”€â”€ handleModelsRequest()
â””â”€â”€ ğŸ¨ UIç•Œé¢å¤„ç†å™¨
    â””â”€â”€ handleGuiRequest()
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆè¯„çº§

| æŠ€æœ¯ | ä½¿ç”¨åœºæ™¯ | éš¾åº¦ | è¯„çº§ | è¯´æ˜ |
|------|----------|------|------|------|
| Cloudflare Workers | æ— æœåŠ¡å™¨å¹³å° | â­â­ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | è¾¹ç¼˜è®¡ç®—ï¼Œå…¨çƒéƒ¨ç½² |
| ES6 Modules | JavaScriptæ¨¡å—åŒ– | â­ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | ç°ä»£JSæ ‡å‡† |
| Mapæ•°æ®ç»“æ„ | æ¨¡å‹æ˜ å°„å­˜å‚¨ | â­ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | é«˜æ•ˆé”®å€¼æŸ¥æ‰¾ |
| Fetch API | HTTPè¯·æ±‚å¤„ç† | â­â­ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | ç°ä»£ç½‘ç»œè¯·æ±‚æ ‡å‡† |
| Server-Sent Events | å®æ—¶æ•°æ®æµ | â­â­â­ | ğŸŒŸğŸŒŸğŸŒŸ | è½»é‡çº§å®æ—¶é€šä¿¡ |
| CSS Variables | ä¸»é¢˜ç³»ç»Ÿ | â­ | ğŸŒŸğŸŒŸğŸŒŸğŸŒŸ | åŠ¨æ€æ ·å¼ç®¡ç† |

## ğŸ” æŠ€æœ¯æ·±åº¦è§£æ

### âš¡ é«˜çº§ä»£ç æŠ€å·§

#### 1. æ™ºèƒ½é”™è¯¯å¤„ç†
```javascript
// ä½¿ç”¨ Promise.allSettled è€Œä¸æ˜¯ Promise.all
// è¿™æ ·å³ä½¿æŸä¸ªæä¾›å•†å¤±è´¥ï¼Œä¹Ÿä¸ä¼šå½±å“å…¶ä»–æä¾›å•†çš„æ¨¡å‹å‘ç°
await Promise.allSettled(fetchPromises);
```

#### 2. å¤šæ ¼å¼å“åº”è§£æ
```javascript
// æ™ºèƒ½é€‚åº”ä¸åŒä¸Šæ¸¸APIçš„å“åº”æ ¼å¼
if (Array.isArray(data)) {
    models = data.map(m => m.id || m.name).filter(Boolean);
} else if (data.data && Array.isArray(data.data)) {
    models = data.data.map(m => m.id).filter(Boolean);
} else if (data.models && Array.isArray(data.models)) {
    models = data.models.map(m => m.name).filter(Boolean);
}
```

#### 3. æµå¼å“åº”å¤„ç†
```javascript
// ä½¿ç”¨ ReadableStream å¤„ç†SSEæµ
const reader = response.body.getReader();
while (true) {
    const { done, value } = await reader.read();
    if (done) break;
    // å®æ—¶å¤„ç†æ•°æ®å—...
}
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬çƒ­çƒˆæ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼ğŸ‰

### ğŸ’¡ å¦‚ä½•è´¡çŒ®

1. **æŠ¥å‘Šé—®é¢˜**: å‘ç°bugï¼Ÿè¯·åˆ›å»ºIssue
2. **åŠŸèƒ½å»ºè®®**: æœ‰å¥½ç‚¹å­ï¼Ÿæ¬¢è¿è®¨è®ºï¼
3. **ä»£ç è´¡çŒ®**: æäº¤Pull Request
4. **æ–‡æ¡£æ”¹è¿›**: å¸®åŠ©å®Œå–„æ–‡æ¡£
5. **æµ‹è¯•å¸®åŠ©**: ååŠ©æµ‹è¯•å’ŒéªŒè¯

### ğŸ¯ è´¡çŒ®è€…å…¬çº¦

- ğŸ™ å°Šé‡æ¯ä¸ªäººçš„æ„è§
- ğŸ’¬ å‹å¥½æ²Ÿé€šè®¨è®º
- ğŸš€ é¼“åŠ±åˆ›æ–°æƒ³æ³•
- ğŸŒŸ è®¤å¯æ¯ä¸ªè´¡çŒ®çš„ä»·å€¼

---

<div align="center">

## ğŸŠ æ„Ÿè°¢ä½¿ç”¨ï¼

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªâ­Staræ”¯æŒä¸€ä¸‹ï¼**

> ğŸ’« *"æŠ€æœ¯åº”è¯¥è®©ç”Ÿæ´»æ›´ç®€å•ï¼Œè€Œä¸æ˜¯æ›´å¤æ‚ã€‚"* - æœ¬é¡¹ç›®å“²å­¦

**å¿«ä¹ç¼–ç ï¼** ğŸš€âœ¨

</div>
